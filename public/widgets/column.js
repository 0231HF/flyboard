// Initialise columns/* *	Copy the each() function for each sparkline you have * 	e.g. $('#spark-1').each(function(){.....} */$(function () {    $('.widget[data-type=5]').each(function () {        var config = $(this).data('config');        var $container = $(this).find('.content');        var timeLine = [];        var dataSeries = [];        config.dataInfos = config.dataInfos || [];        var promises = config.dataInfos.map(function(dataInfo){            return $.get('/api/data_sources/' + dataInfo.id)                .then(function(dataSource){                    return $.get('/api/data_sources/' + dataSource.id + '/records?limit=' + config.limit)                        .then(function(records){                            records.forEach(function(record){                                timeLine.push(record.date_time);                            });                            return {                                name: dataSource.name,                                data: records                            };                        });                });        });        $.when.apply(null,promises).then(function(){            dataSeries = Array.prototype.slice.apply(arguments);            console.log(dataSeries);            $container.highcharts({                chart: {                    type: 'column'                },                title: {                    text: null                },                xAxis: {                    categories: timeLine                },                yAxis: {                    title: {                        text: 'Rainfall (mm)'                    }                },                tooltip: {                    headerFormat: '<span style="font-size:10px">{point.key}</span><table>',                    pointFormat: '<tr><td style="color:{series.color};padding:0">{series.name}: </td>' +                        '<td style="padding:0"><b>{point.y:.1f} mm</b></td></tr>',                    footerFormat: '</table>',                    shared: true,                    useHTML: true                },                plotOptions: {                    column: {                        pointPadding: 0.2,                        borderWidth: 0                    }                },                series: dataSeries            });        });    });});