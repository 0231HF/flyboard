// Initialise pies/* * */$(function(){    $('.widget[data-type=2]').each(function(){        var $container = $(this).find('.cf-pie');        var pId = $container.prop('id');        var config = $(this).data('config');        /*        // Set options per chart        customOptions = {};        customOptions.animation = false;        cf_rPs[pId].options = customOptions;        */        function reload(){            // Store chart information            cf_rPs[pId] = {};            cf_rPs[pId].data = [];            var promises = config.dataSources.map(function(dataSource){                return $.get(                    '/api/data_sources/' + dataSource.id + '/records?limit=1'                ).then(function(resp) {                        resp.forEach(function (record) {                            cf_rPs[pId].data.push({                                value: record.value,                                color: dataSource.color,                                label: dataSource.label                            });                        });                    }                );            });            $.when.apply(null, promises).done(function () {                createPieChart($container);            });        }        //setInterval(reload, config.reloadInterval);        reload();    });});